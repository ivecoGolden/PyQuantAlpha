# PyQuantAlpha ç³»ç»Ÿæ¶æ„è®¾è®¡

> **AI é©±åŠ¨çš„é‡åŒ–äº¤æ˜“ç­–ç•¥ç”Ÿæˆä¸æ‰§è¡Œå¹³å°**

ç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€åˆ›å»ºäº¤æ˜“ç­–ç•¥ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆç­–ç•¥ä»£ç ã€å‰ç«¯é¡µé¢ï¼Œå¹¶æ”¯æŒå‚æ•°è°ƒèŠ‚ã€å›æµ‹ä¸è‡ªåŠ¨äº¤æ˜“ã€‚

---

## ğŸ“‹ å¼€å‘çŠ¶æ€æ¦‚è§ˆ

> **æ›´æ–°äº Phase 3 å®Œæˆå (2025-12-27)**
>
> æœ¬æ–‡æ¡£æ˜¯**äº§å“æ„¿æ™¯è§„åˆ’æ–‡æ¡£**ï¼Œæè¿°ç³»ç»Ÿçš„å®Œæ•´ç›®æ ‡è“å›¾ã€‚
> å®é™…ä»£ç ç»“æ„è¯·å‚è€ƒ [ARCHITECTURE_DIAGRAM.md](./ARCHITECTURE_DIAGRAM.md)ã€‚

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **AI ç­–ç•¥ç”Ÿæˆ** | âœ… å·²å®ç° | LLM æ¥å…¥ã€Prompt æ¨¡æ¿ã€ä»£ç æ ¡éªŒ |
| **ç­–ç•¥ä»£ç ç”Ÿæˆ** | âœ… å·²å®ç° | ç›´æ¥ç”Ÿæˆ Python ç­–ç•¥ï¼Œæ—  IR ä¸­é—´å±‚ |
| **å›æµ‹å¼•æ“** | âœ… å·²å®ç° | äº‹ä»¶é©±åŠ¨ã€å¤šèµ„äº§ã€Sizer/Slippage/Commission |
| **æŠ€æœ¯æŒ‡æ ‡åº“** | âœ… å·²å®ç° | SMA/EMA/RSI/MACD/ATR/BB/ADX/Ichimoku ç­‰ |
| **æ•°æ®æŒä¹…åŒ–** | âœ… å·²å®ç° | SQLite + SQLAlchemyï¼Œé€æ˜åŒæ­¥ |
| **ä¸šç»©åˆ†æå™¨** | âœ… å·²å®ç° | Sharpe/Sortino/MaxDrawdown/Returns |
| **å‰ç«¯åŸºç¡€** | âœ… å·²å®ç° | ç­–ç•¥è¾“å…¥ã€å›æµ‹å±•ç¤ºã€TradingView å›¾è¡¨ |
| IR ä¸­é—´è¡¨ç¤º | ğŸ”² è§„åˆ’ä¸­ | ç»“æ„åŒ–ç­–ç•¥æè¿°å±‚ |
| å‰ç«¯é¡µé¢è‡ªåŠ¨ç”Ÿæˆ | ğŸ”² è§„åˆ’ä¸­ | åŠ¨æ€ UI ç»„ä»¶ç”Ÿæˆ |
| æ¨¡æ‹Ÿç›˜è¿è¡Œ | ğŸ”² è§„åˆ’ä¸­ | çœŸå®è¡Œæƒ…è™šæ‹Ÿæ’®åˆ |
| å®ç›˜äº¤æ˜“ | ğŸ”² è§„åˆ’ä¸­ | å°é¢å®ç›˜ â†’ æ­£å¸¸å®ç›˜ |
| å®æ—¶é£æ§ç›‘æ§ | ğŸ”² è§„åˆ’ä¸­ | ç†”æ–­å‘Šè­¦æœºåˆ¶ |

---

## 1. ç³»ç»Ÿç›®æ ‡ä¸å®šä½

### 1.1 æ ¸å¿ƒèƒ½åŠ›

| åŠŸèƒ½æ¨¡å— | æè¿° |
|---------|------|
| ç­–ç•¥è§£æ | è‡ªç„¶è¯­è¨€ â†’ ä¸­é—´è¡¨ç¤º (IR) |
| ä»£ç ç”Ÿæˆ | IR â†’ Python ç­–ç•¥ä»£ç  |
| UI ç”Ÿæˆ | è‡ªåŠ¨ç”Ÿæˆå¯è°ƒå‚æ•°è¡¨å• + è‡ªå®šä¹‰ UI |
| å›æµ‹å¼•æ“ | å†å²è¡Œæƒ…éªŒè¯ + é£é™©åˆ†æ |
| å®ç›˜è¿è¡Œ | æ¨¡æ‹Ÿç›˜ â†’ å°é¢å®ç›˜ â†’ æ­£å¸¸å®ç›˜ |
| é£æ§ç›‘æ§ | å®æ—¶é£é™©æ£€æµ‹ä¸å‘Šè­¦ |

### 1.2 æ ¸å¿ƒç†å¿µ

> **AI æ˜¯ç­–ç•¥ç¼–è¯‘å™¨ï¼Œç³»ç»Ÿæ˜¯è¿è¡Œæ—¶ç¯å¢ƒã€‚**

- ç”¨æˆ·æ— éœ€ç¼–ç¨‹å³å¯åˆ›å»ºä¸“ä¸šç­–ç•¥
- LLM ä»…è´Ÿè´£ç”Ÿæˆï¼Œä¸ç›´æ¥æ‰§è¡Œäº¤æ˜“
- æ‰€æœ‰äº¤æ˜“é€šè¿‡å®‰å…¨çš„è¿è¡Œæ—¶ API æ‰§è¡Œ

---

## 2. ç³»ç»Ÿæ¶æ„

```mermaid
flowchart TD
    subgraph ç”¨æˆ·å±‚["ğŸ‘¤ ç”¨æˆ·å±‚"]
        User[ç”¨æˆ·è¾“å…¥<br/>è‡ªç„¶è¯­è¨€ç­–ç•¥]
        FE[å‰ç«¯ Web åº”ç”¨]
    end

    subgraph ç¼–è¯‘å±‚["ğŸ§  LLM ç¼–è¯‘å±‚"]
        LLM[LLM ç¼–è¯‘æœåŠ¡]
        IR[ç­–ç•¥ IR<br/>JSON/DSL]
        STRCODE[ç­–ç•¥ä»£ç è‰ç¨¿]
        UICODE[å‰ç«¯é¡µé¢è‰ç¨¿]
    end

    subgraph æ ¡éªŒå±‚["ğŸ”’ å®‰å…¨æ ¡éªŒå±‚"]
        IRValidator[IR æ ¡éªŒ<br/>é£æ§æ£€æŸ¥]
        StrategySanitizer[ç­–ç•¥ä»£ç é™æ€æ£€æŸ¥<br/>åªèƒ½è°ƒç”¨æŠ½è±¡API]
        UISanitizer[å‰ç«¯ä»£ç æ ¡éªŒ<br/>ç»„ä»¶ç™½åå•/éš”ç¦»]
    end

    subgraph å­˜å‚¨å±‚["ğŸ’¾ å­˜å‚¨å±‚"]
        StrategyRepo[(ç­–ç•¥ä»£ç ä»“åº“)]
        PageRepo[(UI ä»“åº“)]
        Data[(å†å²ä¸å®æ—¶è¡Œæƒ…)]
    end

    subgraph è¿è¡Œå±‚["âš™ï¸ è¿è¡Œå±‚"]
        Runtime[ç­–ç•¥è¿è¡Œæ—¶å¼•æ“]
        Backtest[å›æµ‹å¼•æ“]
        TradeLayer[äº¤æ˜“æŠ½è±¡å±‚]
        Monitor[è¿è¡Œç›‘æ§<br/>å‘Šè­¦]
    end

    subgraph äº¤æ˜“æ‰€["ğŸ¦ äº¤æ˜“æ‰€"]
        BinanceAdapter[Binance é€‚é…å™¨]
        Binance[(Binance)]
    end

    User --> FE
    FE --> LLM
    LLM --> IR
    LLM --> STRCODE
    LLM --> UICODE

    IR --> IRValidator
    STRCODE --> StrategySanitizer
    UICODE --> UISanitizer

    StrategySanitizer --> StrategyRepo
    UISanitizer --> PageRepo

    StrategyRepo --> Runtime
    StrategyRepo --> Backtest
    Data --> Backtest
    Data --> Runtime

    Runtime --> TradeLayer
    TradeLayer --> BinanceAdapter
    BinanceAdapter --> Binance

    Runtime --> Monitor
    Backtest --> FE
    PageRepo --> FE
    Monitor --> FE
```

> **æ³¨**: å†å²è¡Œæƒ…ä¾› Backtest ä½¿ç”¨ï¼Œå®æ—¶è¡Œæƒ…åŒæ—¶è¾“å…¥ Runtime ä½œä¸º `on_bar`/`on_tick` è§¦å‘æºã€‚

---

## 3. ç”¨æˆ·å·¥ä½œæµç¨‹

### 3.1 ç­–ç•¥è¾“å…¥

ç”¨æˆ·ä»¥è‡ªç„¶è¯­è¨€æè¿°ç­–ç•¥ï¼š

```text
ç”¨ BTCUSDT 1h Kçº¿ï¼Œ
å½“ EMA20 ä¸Šç©¿ EMA60 æ—¶åšå¤š 30% ä»“ä½ï¼Œ
ä»·æ ¼è·Œç ´ EMA20 æ—¶å¹³ä»“ï¼Œ
æœ€å¤§ä»“ä½ 50%ï¼Œæ­¢æŸ 2%ã€‚
```

> [!TIP]
> **å®¹é”™è¾“å…¥æ”¯æŒ**ï¼šç”¨æˆ·å¯æä¾›æˆªå›¾ã€å›¾è¡¨æˆ–é›¶æ•£ä¿¡æ¯ï¼ŒLLM ä¼šä»å¤šæ¨¡æ€/ç¢ç‰‡åŒ–çº¿ç´¢ä¸­æå–ç­–ç•¥è¦ç´ ã€‚

### 3.2 ç”Ÿæˆ IRï¼ˆä¸­é—´è¡¨ç¤ºï¼‰

LLM å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºç»“æ„åŒ– IRï¼š

```json
{
  "symbol": "BTCUSDT",
  "timeframe": "1h",

  "indicators": [
    { "name": "EMA", "period": 20, "alias": "ema20" },
    { "name": "EMA", "period": 60, "alias": "ema60" }
  ],

  "params": {
    "ema_short": { "default": 20, "min": 5, "max": 100 },
    "ema_long": { "default": 60, "min": 10, "max": 200 },
    "max_position": { "default": 0.5, "min": 0.1, "max": 1.0 },
    "stop_loss": { "default": 0.02, "min": 0.005, "max": 0.1 }
  },

  "entry_rules": [
    { "side": "long", "condition": "cross_over(ema20, ema60)", "size": 0.3 }
  ],

  "exit_rules": [
    { "condition": "price < ema20", "action": "close_all" }
  ],

  "risk": {
    "max_position": 0.5,
    "stop_loss": 0.02
  }
}
```

### 3.3 IR Schema å®šä¹‰

| å­—æ®µ | æè¿° |
|------|------|
| `symbol` / `timeframe` | äº¤æ˜“æ ‡çš„ä¸å‘¨æœŸ |
| `indicators[]` | æŒ‡æ ‡åç§°ã€å‚æ•°ã€åˆ«å |
| `params` | å¯è°ƒå‚æ•°ï¼ˆé»˜è®¤å€¼ã€ä¸Šä¸‹é™ï¼‰ï¼Œç”¨äºå›æµ‹/å®ç›˜ä¸å‰ç«¯è¡¨å• |
| `entry_rules[]` / `exit_rules[]` | æ¡ä»¶è¡¨è¾¾å¼ã€æ–¹å‘ã€ä»“ä½/åŠ¨ä½œ |
| `risk` | `max_position`ã€`stop_loss`ã€`max_leverage` ç­‰ç¡¬æ€§çº¦æŸ |
| `meta` | (å¯é€‰) æè¿°ã€æ ‡ç­¾ã€åˆè§„å¤‡æ³¨ |

> [!IMPORTANT]
> æ‰€æœ‰æ•°å€¼å‡ä¸ºå°æ•°æ¯”ä¾‹ï¼Œå¦‚ `0.02` = 2%ã€‚UI å‚æ•°è¡¨å•ç›´æ¥ç”± `params` ç”Ÿæˆï¼Œæ— éœ€å¦èµ·é…ç½®ã€‚

---

## 4. IR æ ¡éªŒä¸é£æ§

### 4.1 é™æ€æ£€æŸ¥é¡¹

| æ£€æŸ¥é¡¹ | è¯´æ˜ |
|--------|------|
| âœ… å¿…é¡»æœ‰æ­¢æŸ | ç¦æ­¢æ— ä¿æŠ¤ç­–ç•¥ |
| âœ… æœ€å¤§ä»“ä½åˆæ³• | ä¸è¶…è¿‡è´¦æˆ·é™åˆ¶ |
| âœ… æ æ†é™åˆ¶ | ç¬¦åˆäº¤æ˜“æ‰€è§„åˆ™ |
| âŒ ç¦æ­¢æ— æ­¢æŸé©¬ä¸ | Martingale: äºæŸååŠ å€åŠ ä»“ |
| âœ… å‚æ•°åŒºé—´åˆæ³• | å€¼åœ¨ min/max èŒƒå›´å†… |
| âœ… æŒ‡æ ‡å­˜åœ¨æ€§ | å¼•ç”¨çš„æŒ‡æ ‡å¿…é¡»å·²å®ç° |

### 4.2 å®‰å…¨æœºåˆ¶

```mermaid
flowchart LR
    A[ç”¨æˆ·è¾“å…¥] --> B{ç°åå•æ£€æµ‹}
    B -->|è¶Šæƒè¯·æ±‚| C[æ‹’ç»å¹¶æç¤º]
    B -->|æ­£å¸¸è¯·æ±‚| D[IR ç”Ÿæˆ]
    D --> E{IRValidator}
    E -->|å¤±è´¥| F[è¿”å›é”™è¯¯è¯´æ˜]
    E -->|é€šè¿‡| G[è¿›å…¥ç”Ÿæˆé˜¶æ®µ]
```

> [!CAUTION]
> è¶Šæƒè¯·æ±‚å°†è¢«æ‹’ç»ï¼šå¦‚"å¿½ç•¥é™åˆ¶"ã€"å…¨ä»“ 20 å€æ æ†"ã€æ— æ­¢æŸåŠ ä»“ç­‰ã€‚

- **IRValidator**: ä»…åšé™æ€é£æ§/åˆè§„æ£€æŸ¥
- **RiskEngine**: åŠ¨æ€é£æ§ï¼ˆå®ç›˜ç†”æ–­ã€é£æ§äº‹ä»¶ï¼‰åœ¨ Runtime æ‰§è¡Œ

---

## 5. ç­–ç•¥ä»£ç ç”Ÿæˆ

ä» IR æ¨¡æ¿ç”Ÿæˆ Python ç­–ç•¥ä»£ç ï¼š

```python
from runtime_api import order, close_all, indicator

class Strategy:
    params = {
        "ema_short": 20,
        "ema_long": 60,
        "max_position": 0.5,
        "stop_loss": 0.02
    }

    def init(self):
        self.ema20 = indicator.EMA(self.params["ema_short"])
        self.ema60 = indicator.EMA(self.params["ema_long"])
        self.last_entry_price = None

    def on_bar(self, bar):
        self.ema20.update(bar.close)
        self.ema60.update(bar.close)

        # å…¥åœºé€»è¾‘
        if not self.position and self.ema20.cross_over(self.ema60):
            if self.position_size < self.params["max_position"]:
                size = self.equity * 0.3 / bar.close
                order("BTCUSDT", "BUY", size)
                self.last_entry_price = bar.close

        # å‡ºåœºé€»è¾‘
        if self.position and self.last_entry_price:
            # æ­¢æŸ
            if bar.close <= self.last_entry_price * (1 - self.params["stop_loss"]):
                close_all("BTCUSDT")
            # EMA è·Œç ´
            elif bar.close < self.ema20.value:
                close_all("BTCUSDT")
```

### 5.1 è¿è¡Œæ—¶ä¸Šä¸‹æ–‡

| å±æ€§/æ–¹æ³• | æè¿° |
|-----------|------|
| `self.position` | å½“å‰æŒä»“çŠ¶æ€ |
| `self.position_size` | æŒä»“è§„æ¨¡ |
| `self.equity` | è´¦æˆ·å‡€å€¼ |
| `order()` | ä¸‹å•æ¥å£ |
| `close_all()` | å¹³ä»“æ¥å£ |
| `indicator.*` | æŒ‡æ ‡è®¡ç®—å™¨ |

> [!WARNING]
> ç­–ç•¥ä»£ç åªèƒ½è°ƒç”¨ `runtime_api` ç™½åå• APIï¼Œæ— æ³•ç›´æ¥è®¿é—®äº¤æ˜“æ‰€ SDKã€‚

---

## 6. å‰ç«¯é¡µé¢ç”Ÿæˆ

### 6.1 é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç­–ç•¥æ ‡é¢˜ & æè¿°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å‚æ•°è¡¨å•       â”‚    è‡ªå®šä¹‰ UI åŒº    â”‚
â”‚   (ç³»ç»Ÿç”Ÿæˆ)     â”‚    (AI ç”Ÿæˆ)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       å›æµ‹ç»“æœ / å®ç›˜çŠ¶æ€             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å‚æ•°è¡¨å•è‡ªåŠ¨ç”Ÿæˆ

**ä» IR ä¸­æå– `params` å­—æ®µï¼š**

```json
{
  "ema_short": { "default": 20, "min": 5, "max": 100 },
  "ema_long": { "default": 60, "min": 10, "max": 200 },
  "max_position": { "default": 0.5, "min": 0.1, "max": 1.0 }
}
```

**è‡ªåŠ¨ç”Ÿæˆ UI é…ç½®ï¼š**

```json
[
  { "name": "ema_short", "label": "çŸ­å‘¨æœŸ EMA", "type": "number", "default": 20 },
  { "name": "ema_long", "label": "é•¿å‘¨æœŸ EMA", "type": "number", "default": 60 },
  { "name": "max_position", "label": "æœ€å¤§ä»“ä½", "type": "number", "default": 0.5 }
]
```

æ¸²æŸ“ä¸º `<ParamForm />` ç»„ä»¶ã€‚

### 6.3 è‡ªå®šä¹‰ UIï¼ˆAI ç”Ÿæˆï¼‰

ç”¨æˆ·å¯é€šè¿‡è‡ªç„¶è¯­è¨€æ‰©å±• UIï¼š

```text
å³ä¾§åŠ ä¸€ä¸ªæ”¶ç›Šæ›²çº¿å’Œæœ€è¿‘ 20 ç¬”äº¤æ˜“è¡¨æ ¼
```

**ç”Ÿæˆä»£ç ï¼š**

```jsx
<LineChart data={backtest.equityCurve} />
<TradeTable trades={backtest.trades.slice(0, 20)} />
```

### 6.4 UI å®‰å…¨çº¦æŸ

| çº¦æŸ | è¯´æ˜ |
|------|------|
| ç»„ä»¶ç™½åå• | åªèƒ½ä½¿ç”¨é¢„å®šä¹‰ç»„ä»¶ |
| DOM éš”ç¦» | ç¦æ­¢è®¿é—® `window`/`document`/`localStorage` |
| æ•°æ®æ³¨å…¥ | æ‰€æœ‰æ•°æ®ä» `props` ä¼ å…¥ |
| æ²™ç®±æ‰§è¡Œ | iframe/å¾®å‰ç«¯å®¹å™¨éš”ç¦» |

---

## 7. å›æµ‹ä¸å®ç›˜

### 7.1 å›æµ‹å¼•æ“

**ç›®çš„**ï¼šç”¨å†å²è¡Œæƒ…éªŒè¯ç­–ç•¥é€»è¾‘ä¸é£é™©ç‰¹å¾ï¼Œä¸ºå®ç›˜åšå…¥å£å‡†å…¥ã€‚

#### è¾“å…¥é…ç½®

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| ç­–ç•¥ä»£ç  | å«å‚æ•°é»˜è®¤å€¼ |
| å†å²è¡Œæƒ… | K çº¿/é€ç¬”ï¼ˆæ—¶é—´æˆ³ã€OHLCVï¼‰ |
| æ—¶é—´åŒºé—´ | å›æµ‹èµ·æ­¢æ—¶é—´ |
| æ»‘ç‚¹/æ‰‹ç»­è´¹ | æ¨¡æ‹ŸçœŸå®äº¤æ˜“æˆæœ¬ |
| åˆå§‹èµ„é‡‘ | èµ·å§‹è´¦æˆ·ä½™é¢ |
| å¹´åŒ–æ—¥æ•° | ç°è´§ 365 / ä¼ ç»Ÿ 252ï¼ˆå¯é…ç½®ï¼‰ |

#### å¤„ç†æµç¨‹

```mermaid
flowchart LR
    A[åŠ è½½è¡Œæƒ…] --> B[æ—¶åŒºå¯¹é½<br/>æŒ‡æ ‡é¢„çƒ­]
    B --> C[æŒ‰ K çº¿è°ƒç”¨ on_bar]
    C --> D[æ¨¡æ‹Ÿæ’®åˆ<br/>è´¹ç‡/æ»‘ç‚¹]
    D --> E[è®°å½•æˆäº¤<br/>å‡€å€¼æ›²çº¿]
    E --> F[è®¡ç®—æŒ‡æ ‡<br/>ç”ŸæˆæŠ¥è¡¨]
```

#### è¾“å‡ºæŒ‡æ ‡

| æŒ‡æ ‡ | è®¡ç®—æ–¹å¼ |
|------|---------|
| **æ”¶ç›Šæ›²çº¿** | æŒ‰æ—¶é—´æ’åºçš„å‡€å€¼åºåˆ—ï¼ˆå«åŸºå‡†å¯¹æ¯”ï¼‰ |
| **å¹´åŒ–æ”¶ç›Š** | `(æœ€ç»ˆå‡€å€¼)^(å¹´åŒ–æ—¥æ•°/äº¤æ˜“æ—¥æ•°) - 1` |
| **æœ€å¤§å›æ’¤** | å³°å€¼åˆ°è°·å€¼çš„æœ€å¤§è·Œå¹… |
| **å¤æ™®æ¯”ç‡** | è¶…é¢æ”¶ç›Šå‡å€¼ / æ³¢åŠ¨ç‡ï¼ˆå¹´åŒ–ï¼‰ |
| **èƒœç‡** | ç›ˆåˆ©ç¬”æ•° / æ€»äº¤æ˜“ç¬”æ•° |
| **äº¤æ˜“æ˜ç»†** | é€ç¬”è®°å½• + é£æ§äº‹ä»¶æ—¥å¿— |

### 7.2 å®ç›˜è¿è¡Œ

#### é˜¶æ®µé—¸é—¨

```mermaid
flowchart LR
    A[å›æµ‹é€šè¿‡] --> B[æ¨¡æ‹Ÿç›˜]
    B --> C[å°é¢å®ç›˜]
    C --> D[æ­£å¸¸å®ç›˜]
    
    A -.->|æ”¶ç›Š/å›æ’¤è¾¾æ ‡| B
    B -.->|ä¿¡å·ç¨³å®š| C
    C -.->|æˆäº¤ç‡/æ»‘ç‚¹éªŒè¯| D
```

| é˜¶æ®µ | å‡†å…¥æ¡ä»¶ |
|------|---------|
| **å›æµ‹é€šè¿‡** | æ”¶ç›Š/å›æ’¤/å¤æ™®/èƒœç‡è¾¾æ ‡ï¼Œæ— é£æ§è¿è§„ |
| **æ¨¡æ‹Ÿç›˜** | çœŸå®è¡Œæƒ…è™šæ‹Ÿæ’®åˆï¼ŒéªŒè¯å»¶è¿Ÿä¸ä¿¡å·ç¨³å®šæ€§ |
| **å°é¢å®ç›˜** | é™é¢é™é¢‘ï¼ŒéªŒè¯å§”æ‰˜æˆäº¤ç‡å’Œæ»‘ç‚¹ |
| **æ­£å¸¸å®ç›˜** | æ”¾å¼€é¢åº¦ï¼ŒæŒç»­é£æ§ç›‘æ§ |

#### é£æ§ä¿æŠ¤

| å±‚çº§ | æªæ–½ |
|------|------|
| **è´¦æˆ·ä¾§** | æœ€å¤§ä»“ä½ã€æ æ†ä¸Šé™ã€å•ç¬”/æ—¥ç´¯è®¡é™åˆ¶ |
| **ç­–ç•¥ä¾§** | å¼ºåˆ¶æ­¢æŸã€ç¦æ­¢é©¬ä¸ã€é£æ§äº‹ä»¶è‡ªåŠ¨å¹³ä»“ |
| **é¢‘ç‡æ§åˆ¶** | æœ€å°ä¸‹å•é—´éš”ã€åŒå‘è¿å‘é™åˆ¶ã€é˜²æŠ– |
| **å®¡è®¡å‘Šè­¦** | æ¯ç¬”è®°å½•ã€å¼‚å¸¸æ¨é€ï¼ˆçŸ­ä¿¡/IM/é‚®ä»¶ï¼‰ |

---

## 8. å®‰å…¨ä¸é£æ§åŸåˆ™

### 8.1 æ¨¡å‹ä¸äº¤æ˜“éš”ç¦»

```mermaid
flowchart LR
    LLM[LLM æ¨¡å‹] -->|ç”Ÿæˆ| Code[ç­–ç•¥ä»£ç ]
    Code -->|è°ƒç”¨| API[runtime_api]
    API -->|æ‰§è¡Œ| Trade[äº¤æ˜“æ‰€]
    
    LLM x--x|ç¦æ­¢ç›´æ¥è®¿é—®| Trade
```

- âœ… LLM ä»…ç”Ÿæˆä»£ç ï¼Œä¸ç›´æ¥äº¤æ˜“
- âœ… æ‰€æœ‰ä¸‹å•é€šè¿‡ `runtime_api`
- âœ… ç­–ç•¥ä»£ç åªèƒ½è°ƒç”¨ç™½åå• API

### 8.2 å¼ºåˆ¶é£é™©é™åˆ¶

| é™åˆ¶ | è¯´æ˜ |
|------|------|
| ğŸ›‘ å¼ºåˆ¶æ­¢æŸ | æ‰€æœ‰ç­–ç•¥å¿…é¡»è®¾ç½®æ­¢æŸ |
| ğŸ“Š æœ€å¤§ä»“ä½ | ä¸è¶…è¿‡è´¦æˆ·è®¾å®šæ¯”ä¾‹ |
| âš¡ æœ€å¤§æ æ† | ç¬¦åˆäº¤æ˜“æ‰€ä¸ç”¨æˆ·è®¾å®š |
| ğŸš« ç¦æ­¢é©¬ä¸ | äºæŸåé€’å¢åŠ ä»“è¢«ç¦æ­¢ |
| ğŸ• è®¢å•é€Ÿç‡ | é˜²æ­¢è¿‡åº¦äº¤æ˜“ |

### 8.3 æ²™ç®±ä¸å®¡æ ¸

- ç­–ç•¥ä¸ UI é¡µé¢éœ€è¦**é¢„è§ˆ**
- é€šè¿‡å®¡æ ¸åæ‰å‘ç”¨æˆ·**ä¸Šçº¿**
- AST é™æ€æ£€æŸ¥ + æ²™ç®±éš”ç¦»æ‰§è¡Œ

---

## 9. ç”¨æˆ·äº¤äº’æµç¨‹

```mermaid
flowchart TD
    A[1ï¸âƒ£ è¾“å…¥è‡ªç„¶è¯­è¨€ç­–ç•¥] --> B[2ï¸âƒ£ ç³»ç»Ÿç”Ÿæˆ]
    B --> B1[IR]
    B --> B2[ç­–ç•¥ä»£ç ]
    B --> B3[å‰ç«¯é¡µé¢]
    B --> B4[ç­–ç•¥è¯´æ˜]
    
    B1 & B2 & B3 & B4 --> C[3ï¸âƒ£ ç”¨æˆ·è°ƒå‚]
    C --> D[4ï¸âƒ£ å›æµ‹éªŒè¯]
    D --> E[5ï¸âƒ£ æ¨¡æ‹Ÿç›˜è¿è¡Œ]
    E --> F[6ï¸âƒ£ å°é¢å®ç›˜]
    F --> G[7ï¸âƒ£ è‡ªåŠ¨è¿è¡Œ]
    G --> H[8ï¸âƒ£ ç›‘æ§ä¸å‘Šè­¦]
```

---

## é™„å½•ï¼šé˜¶æ®µ 1 é™åˆ¶

| é¡¹ç›® | å½“å‰æ”¯æŒ |
|------|---------|
| äº¤æ˜“æ‰€ | ä»… Binance |
| èµ„äº§ç±»å‹ | åŠ å¯†è´§å¸ |
| è¡Œæƒ… | K çº¿ï¼ˆTick åç»­æ”¯æŒï¼‰ |
